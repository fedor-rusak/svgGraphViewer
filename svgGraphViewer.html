<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>svgGraphViewer 0.4</title>

		<script>
			"use strict";

			//example data with graph like
			// A ---> B ---> C1
			//           `-> C2 --> D1
			//                  `-> D2
			const inputData = [
				{nodeName: "A", depends:[]},
				{nodeName: "B", depends: ["A"]},
				{nodeName: "C1", depends: ["B"]},
				{nodeName: "C2", depends: ["B"]},
				{nodeName: "D1", depends: ["C2"]},
				{nodeName: "D2", depends: ["C2"]}
			];
		</script>

		<script>
			"use strict";

			//Graph-like data structure.
			const coreGraph = function() {
				const generateGraphStructure = function() {
					//actual instance state
					var nodeNames = [],
					    nodeData = {};

					//newNodeData object is mandatory!
					const addNode = function(newNodeName, newNodeData) {
						newNodeData = newNodeData || {};

						if (nodeData[newNodeName] === undefined && typeof newNodeData === 'object') {
							nodeData[newNodeName] = newNodeData;
							nodeData[newNodeName]["name"] = newNodeName;
							nodeNames.push(newNodeName);
						}
					}

					const getNode = function(nodeName) {
						return nodeData[nodeName];
					}

					return {
						addNode,
						getNode
					};
				};

				//TESTS
				try {
					let testGraph = generateGraphStructure();

					let nodeName = "A";
					let nodeDescription = "A node";
					let nodeData = {description: nodeDescription};
					testGraph.addNode(nodeName, nodeData);
					if (testGraph.getNode(nodeName).description !== nodeDescription) {
						throw new Error("Adding node with data failed!");
					}

					//someone modified added nodeData object
					nodeData.description = "NOT A node";
					if (testGraph.getNode(nodeName).description !== nodeDescription) {
						throw new Error("Node data was modified without proper API call!");
					}
				}
				catch (e) {
					alert("Adding&Getting API failed!\n" + e);
					throw e;
				}

				//module API
				return {
					generateGraphStructure
				}
			}();
		</script>

		<script>
			"use strict";

			window.onload = function () {
				const graphInstance = coreGraph.generateGraphStructure();
				alert("This is the first step in simple SVG graph Viewr application!" + "\nData: \n" +JSON.stringify(inputData, null, 4));
			};
		</script>
	</head>
	<body>
	</body>
</html>